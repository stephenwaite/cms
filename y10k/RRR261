       IDENTIFICATION DIVISION.
       PROGRAM-ID. RRR261.
       AUTHOR. SID WAITE.
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT FILEIN ASSIGN TO "S30"
             ORGANIZATION LINE SEQUENTIAL.
           SELECT FILEOUT ASSIGN TO "S35"
           ORGANIZATION LINE SEQUENTIAL.
           SELECT INSFILE ASSIGN TO "S40" ORGANIZATION IS INDEXED
           ACCESS IS DYNAMIC RECORD KEY IS INS-KEY
           ALTERNATE RECORD KEY IS INS-NAME WITH DUPLICATES
           ALTERNATE RECORD KEY IS INS-CITY WITH DUPLICATES
           ALTERNATE RECORD KEY IS INS-ASSIGN WITH DUPLICATES
           ALTERNATE RECORD KEY IS INS-CLAIMTYPE WITH DUPLICATES
           ALTERNATE RECORD KEY IS INS-NEIC WITH DUPLICATES
           ALTERNATE RECORD KEY IS INS-NEIC-ASSIGN WITH DUPLICATES
           LOCK MODE MANUAL.
       DATA DIVISION.
       FILE SECTION.
       FD  INSFILE
     *     BLOCK CONTAINS 6 RECORDS
           DATA RECORD IS INSFILE01.
       01  INSFILE01.
           02 INS-KEY PIC XXX.
           02 INS-NAME PIC X(22).
           02 INS-STREET PIC X(24).
           02 INS-CITY PIC X(15).
           02 INS-STATE PIC XX.
           02 INS-ZIP PIC X(9).
           02 INS-ASSIGN PIC X.
           02 INS-CLAIMTYPE PIC X.
           02 INS-NEIC PIC X(5).
           02 INS-NEICLEVEL PIC X.
           02 INS-NEIC-ASSIGN PIC X.
           02 INS-PPO PIC X.
           02 INS-PRVNUM PIC X(10).
           02 INS-HMO PIC X(3).
           02 INS-STATUS PIC X.
           02 INS-LEVEL PIC X.
           02 INS-LASTDATE PIC X(8).
           02 INS-CAID PIC XXX.
           02 INS-REFWARN PIC X.
           02 INS-FUTURE PIC X(8).
       FD  FILEIN.
       01  FILEIN01.
           02 FO-INS PIC XXX.
           02 FO-GARNO PIC X(8).
           02 FO-DOBCC PIC XX.
           02 FO-DOBYY PIC XX.
           02 FO-DOBMM PIC XX.
           02 FO-DOBDD PIC XX.
           02 FO-DOC PIC XX.
           02 FO-NAME PIC X(16).
           02 FO-DATE-TCC PIC XX.
           02 FO-DATE-TYY PIC XX.
           02 FO-DATE-TMM PIC XX.
           02 FO-DATE-TDD PIC XX.
           02 FO-PROC PIC X(11).
           02 FO-DATE-ACC PIC XX.
           02 FO-DATE-AYY PIC XX.
           02 FO-DATE-AMM PIC XX.
           02 FO-DATE-ADD PIC XX.
           02 FO-KEY PIC X(6).
           02 FO-PLACE PIC XX.
           02 CUR-KEY PIC X(11).

       FD FILEOUT.
       01 FILEOUT01 PIC X(79).
       WORKING-STORAGE SECTION.
       01  LINE-0.
           02 FILLER PIC X(20) VALUE SPACE.
           02 L0F1 PIC XXX.
           02 FILLER PIC X VALUE SPACE.
           02 L0F2 PIC X(18).
       01 LINE-1.
          02 FILLER PIC X(9) VALUE "ACCT #   ".
          02 FILLER PIC X(11) VALUE "DOB        ".
          02 FILLER PIC X(3) VALUE "DR ".
          02 FILLER PIC X(17) VALUE "PATIENT          ".
          02 FILLER PIC X(11) VALUE "  TRN DATE ".
          02 FILLER PIC X(11) VALUE "PROC.      ".
          02 FILLER PIC X(10) VALUE "  AGE DATE".
          02 FILLER PIC XXX VALUE " PL".
       01 LINE-2.
           02 L2GARNO PIC X(8).
           02 FILLER PIC X VALUE SPACE.
           02 L2DOBMM PIC XX.
           02 FILLER PIC X VALUE "/".
           02 L2DOBDD PIC XX.
           02 FILLER PIC X VALUE "/".
           02 L2DOBCC PIC XX.
           02 L2DOBYY PIC XX.
           02 FILLER PIC X VALUE SPACE.
           02 L2DOC PIC XX.
           02 FILLER PIC X VALUE SPACE.
           02 L2NAME PIC X(16).
           02 FILLER PIC X VALUE SPACE.
           02 L2DATETMM PIC XX.
           02 FILLER PIC X VALUE "/".
           02 L2DATETDD PIC XX.
           02 FILLER PIC X VALUE "/".
           02 L2DATETCC PIC XX.
           02 L2DATETYY PIC XX.
           02 FILLER PIC X VALUE SPACE.
           02 L2PROC PIC X(11).
           02 FILLER PIC X VALUE SPACE.
           02 L2DATEAMM PIC XX.
           02 FILLER PIC X VALUE "/".
           02 L2DATEADD PIC XX.
           02 FILLER PIC X VALUE "/".
           02 L2DATEACC PIC XX.
           02 L2DATEAYY PIC XX.
           02 FILLER PIC X VALUE SPACE.
           02 L2-PLACE PIC X.
       01  CNTR PIC 99 VALUE 0.
       PROCEDURE DIVISION.
       P0.
           OPEN INPUT FILEIN INSFILE OUTPUT FILEOUT.
           READ FILEIN AT END GO TO P2.
           MOVE FO-INS TO INS-KEY
           READ INSFILE INVALID MOVE "***NO CODE***" TO INS-NAME.
           MOVE INS-NAME TO L0F2
           MOVE INS-KEY TO L0F1
           MOVE SPACES TO FILEOUT01
           WRITE FILEOUT01 FROM LINE-0.
           MOVE SPACES TO FILEOUT01
           WRITE FILEOUT01 FROM LINE-1 AFTER 2
           MOVE SPACES TO FILEOUT01
           WRITE FILEOUT01
           GO TO P1-1.
       P1. READ FILEIN AT END GO TO P2.
       P1-1.
           MOVE FO-DOBCC TO L2DOBCC
           MOVE FO-DOBYY TO L2DOBYY
           MOVE FO-DOBMM TO L2DOBMM
           MOVE FO-DOBDD TO L2DOBDD
           MOVE FO-DATE-TCC TO L2DATETCC
           MOVE FO-DATE-TYY TO L2DATETYY
           MOVE FO-DATE-TMM TO L2DATETMM
           MOVE FO-DATE-TDD TO L2DATETDD
           MOVE FO-DATE-ACC TO L2DATEACC
           MOVE FO-DATE-AYY TO L2DATEAYY
           MOVE FO-DATE-AMM TO L2DATEAMM
           MOVE FO-DATE-ADD TO L2DATEADD
           MOVE FO-NAME TO L2NAME
           MOVE FO-DOC TO L2DOC
           MOVE FO-GARNO TO L2GARNO
           MOVE FO-PROC TO L2PROC
           MOVE FO-PLACE TO L2-PLACE
           MOVE SPACES TO FILEOUT01
           WRITE FILEOUT01 FROM LINE-2
           ADD 1 TO CNTR
           IF CNTR > 60
           MOVE 0 TO CNTR
           PERFORM A1.
           GO TO P1.
       A1. MOVE SPACES TO FILEOUT01
           WRITE FILEOUT01 AFTER PAGE
           MOVE SPACES TO FILEOUT01
           WRITE FILEOUT01 FROM LINE-0
           MOVE SPACES TO FILEOUT01
           WRITE FILEOUT01 FROM LINE-1 AFTER 2
           MOVE SPACE TO FILEOUT01
           WRITE FILEOUT01.
       P2. CLOSE FILEIN FILEOUT INSFILE.
           STOP RUN.
